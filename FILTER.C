#include<stdio.h>
#include<ctype.h>

main()
{
FILE *fi,*fo;
int ch,u=0,v=0,w=0,x=1,y=0,z=0;
clrscr();
if((fi=fopen("c:\\dos\\lib.4gl","rb"))==NULL)
{
perror("Can't open input file ");
exit();
}
if((fo=fopen("c:\\dos\\librj.4gl","wb"))==NULL)
{
perror("Can't open output file ");
exit();
}
textattr(96);
while((ch=getc(fi))!=EOF)
{
if(x&&(ch==10||ch==13||ch==44))
{
v=-1;
u=y=0;
}
else
y=1;
if(isspace(ch)&&x)
{
x=0;
v+=2;
}
if(!isspace(ch)&&v>1&&u&&!z)
{
putch(32);
putc(32,fo);
}
if(w||x||!y)
{
putchar(ch);
putc(ch,fo);
}
if(isspace(ch)&&!x)
x=y=1;
else
{
v=y=0;
u=1;
}
if(ch==123&&!z)
z=1;
else
if(ch==125&&z==1)
z=0;
else
if(ch==34&&(!z||z==2))
z=z?0:2;
else
if(ch==39&&(!z||z==3))
z=z?0:3;
w=z?1:0;
}
}
